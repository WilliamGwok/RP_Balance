# **关于LQR控制器的参数整定技巧**



通过我的建模和控制器设计代码可以了解到，决定LQR控制器参数的Q，R矩阵分别是 **1x10** 的和 **4x1** 的矩阵。单凭感觉或简单的关系推理去给Q，R矩阵赋值，从而得到一组兼顾性能和稳定性的 **K** 参数是十分耗时的。在研发过程中，我通过一些论坛，引用文献等了解到了不少整定参数的技巧，在此提供我认为最有效方法。

### 布莱森法则

一个对矩阵 \( Q \) 和 \( R \) 的简单且合理的选择由布莱森法则给出，如 Bryson 的法则所示 ：选择对角线矩阵 \( Q \) 和 \( R \)，其对角元素为：
$$
Q_{ii} = \frac{1}{\text{最大可接受的 } z_i^2 \text{ 值}}， \quad i \in \{1, 2, \dots, \ell\}
$$

$$
R_{jj} = \frac{1}{\text{最大可接受的 } u_j^2 \text{ 值}}， \quad j \in \{1, 2, \dots, k\}
$$

这对应于以下准则：
$$
J_{LQR} := \int_{0}^{\infty} \left( \sum_{i=1}^{\ell} Q_{ii} z_i(t)^2 + \rho \sum_{j=1}^{m} R_{jj} u(t)^2 \right) dt.
$$


**解释：**

布莱森法则的本质是对 \( **J** \) 中出现的变量进行缩放，以确保每项的**最大可接受值**为 1。这在不同的 \( **u** \) 和 \( **z** \) 分量单位差异较大的情况下尤其重要，因为这些变量的数值差异可能会非常大。

尽管布莱森法则通常会给出良好的结果，但它往往只是设计过程的起点，接下来还需要通过试错迭代的方法，来获得闭环系统的期望特性。

---

简单总结，布莱森法则提供了一种通过缩放矩阵 \( Q \) 和 \( R \) 的方式，使得系统中的不同变量得到适当的加权。

### 示例：

这里给出一个例子（也可以在我的MATLAB代码中查看我的做法）

对于平衡底盘的系统，状态变量 **速度v** 和 **机体倾角Phi** 分别表示系统的两个状态，控制变量 **驱动轮输出扭矩Tw** 是控制输入。假设状态 **v** 的最大可接受值是 **3.5**，状态 **phi** 的最大可接受值是 **5**，控制输入 **Tw** 的最大可接受值是 **4.5**。那么根据布莱森法则，我们可以选择 \( Q \) 和 \( R \) 的对角元素如下：
$$
Q_{22} = \frac{1}{3.5^2} = 0.01, \quad Q_{1010} = \frac{1}{5^2} = 0.04
$$

$$
R_{11} = \frac{1}{4.5^2} = 0.25
$$

然后，将这些值带入LQR的性能指标公式中，用于最小化系统的性能指标。

### 状态变量的最大可接受值：

每个状态变量都代表系统的某种状态，比如位置、速度、倾角等。系统的设计者通常会为这些状态变量设定一个可接受的最大值。如果状态变量超过这个值，系统可能会进入不安全或无效的状态。

#### 举例：
- 机械系统中的一个位置变量可能表示平衡底盘的机体倾角，如果这个角度超过一定值，则机体的导轮会磕到地面或极易失衡。因此，这个角度就是这个状态变量的**最大可接受值**。

---

### 控制输入的最大可接受值：

控制变量表示控制器对系统施加的输入，比如电流、电压、力等。控制输入也有物理限制，超过某个值后可能会损坏系统或使控制器失效。对于平衡底盘，该值可以是实际电机能够输出的最大扭矩。